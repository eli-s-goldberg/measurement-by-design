import{autoType as Ce,tsvParseRows as Me,tsvParse as Pe,csvParseRows as _e,csvParse as De}from"../../d3-dsv@3.0.1/index.js";import{require as Fe,requireFrom as X,resolveFrom as Ue}from"../../d3-require@1.3.0/index.js";import{reverse as Be,greatest as We}from"../../d3-array@3.2.4/index.js";function p(e,t,n){return{resolve(r=n){return`${e}@${t}/${r}`}}}const ze=p("d3","7.9.0","dist/d3.min.js"),He=p("@observablehq/inputs","0.10.6","dist/inputs.min.js"),Ve=p("@observablehq/plot","0.6.14","dist/plot.umd.min.js"),Ge=p("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),S=p("@observablehq/highlight.js","2.0.0","highlight.min.js"),Q=p("@observablehq/katex","0.11.1","dist/katex.min.js"),Ye=p("lodash","4.17.21","lodash.min.js"),Ze=p("htl","0.3.1","dist/htl.min.js"),Je=p("jszip","3.10.1","dist/jszip.min.js"),Xe=p("marked","0.3.12","marked.min.js"),K=p("sql.js","1.8.0","dist/sql-wasm.js"),Qe=p("vega","5.22.1","build/vega.min.js"),Ke=p("vega-lite","5.6.0","build/vega-lite.min.js"),et=p("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),C=p("apache-arrow","4.0.1","Arrow.es2015.min.js"),tt=p("apache-arrow","9.0.0","+esm"),ee=p("apache-arrow","11.0.0","+esm"),nt=p("arquero","4.8.8","dist/arquero.min.js"),rt=p("topojson-client","3.1.0","dist/topojson-client.min.js"),at=p("exceljs","4.3.0","dist/exceljs.min.js"),st=p("mermaid","9.2.2","dist/mermaid.min.js"),te=p("leaflet","1.9.3","dist/leaflet.js"),N=p("@duckdb/duckdb-wasm","1.24.0","+esm"),g="https://cdn.observableusercontent.com/npm/";let $=Fe;function ot(e){$=e}function it(e){return e==null?$:X(e)}async function ne(e){const[t,n]=await Promise.all([e(K.resolve()),e.resolve(K.resolve("dist/"))]);return t({locateFile:r=>`${n}${r}`})}let M=class Re{constructor(t){Object.defineProperties(this,{_db:{value:t}})}static async open(t){const[n,r]=await Promise.all([ne($),Promise.resolve(t).then(P)]);return new Re(new n.Database(r))}async query(t,n){return await ut(this._db,t,n)}async queryRow(t,n){return(await this.query(t,n))[0]||null}async explain(t,n){const r=await this.query(`EXPLAIN QUERY PLAN ${t}`,n);return E("pre",{className:"observablehq--inspect"},[_(r.map(a=>a.detail).join(`
`))])}async describeTables({schema:t}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${t==null?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%' ORDER BY schema, name`,t==null?[]:[t])}async describeColumns({schema:t,table:n}={}){if(n==null)throw new Error("missing table");const r=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${t==null?"":", ?"}) ORDER BY cid`,t==null?[n]:[n,t]);if(!r.length)throw new Error(`table not found: ${n}`);return r.map(({name:a,type:s,notnull:o})=>({name:a,type:ct(s),databaseType:s,nullable:!o}))}async describe(t){const n=await(t===void 0?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[t]));if(!n.length)throw new Error("Not found");const{columns:r}=n;return E("table",{value:n},[E("thead",[E("tr",r.map(a=>E("th",[_(a)])))]),E("tbody",n.map(a=>E("tr",r.map(s=>E("td",[_(a[s])])))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(t,...n){return[t.join("?"),n]}};Object.defineProperty(M.prototype,"dialect",{value:"sqlite"});function ct(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";case"DATE":case"DATETIME":return"string";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function P(e){return typeof e=="string"?fetch(e).then(P):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(P):e instanceof ArrayBuffer?new Uint8Array(e):e}async function ut(e,t,n){const[r]=await e.exec(t,n);if(!r)return[];const{columns:a,values:s}=r,o=s.map(c=>Object.fromEntries(c.map((d,u)=>[a[u],d])));return o.columns=a,o}function E(e,t,n){arguments.length===2&&(n=t,t=void 0);const r=document.createElement(e);if(t!==void 0)for(const a in t)r[a]=t[a];if(n!==void 0)for(const a of n)r.appendChild(a);return r}function _(e){return document.createTextNode(e)}function L(e){return e&&typeof e.toArrowBuffer=="function"}function j(e){return e&&typeof e.getChild=="function"&&typeof e.toArray=="function"&&e.schema&&Array.isArray(e.schema.fields)}function re(e){return e.schema.fields.map(lt)}function lt(e){return{name:e.name,type:ft(e.type),nullable:e.nullable,databaseType:String(e.type)}}function ft(e){switch(e.typeId){case 2:return"integer";case 3:case 7:return"number";case 4:case 15:return"buffer";case 5:return"string";case 6:return"boolean";case 8:case 9:case 10:return"date";case 12:case 16:return"array";case 13:case 14:return"object";case 11:case 17:default:return"other"}}async function D(){return await import(`${g}${ee.resolve()}`)}let F,U=class ke{constructor(t){Object.defineProperties(this,{_db:{value:t}})}async queryStream(t,n){const r=await this._db.connect();let a,s;try{if(n?.length>0?a=await(await r.prepare(t)).send(...n):a=await r.send(t),s=await a.next(),s.done)throw new Error("missing first batch")}catch(o){throw await r.close(),o}return{schema:re(s.value),async*readRows(){try{for(;!s.done;)yield s.value.toArray(),s=await a.next()}finally{await r.close()}}}}async query(t,n){const r=await this.queryStream(t,n),a=[];for await(const s of r.readRows())for(const o of s)a.push(o);return a.schema=r.schema,a}async queryRow(t,n){const r=(await this.queryStream(t,n)).readRows();try{const{done:a,value:s}=await r.next();return a||!s.length?null:s[0]}finally{await r.return()}}async sql(t,...n){return await this.query(t.join("?"),n)}queryTag(t,...n){return[t.join("?"),n]}escape(t){return`"${t}"`}async describeTables(){return(await this.query("SHOW TABLES")).map(({name:t})=>({name:t}))}async describeColumns({table:t}={}){return(await this.query(`DESCRIBE ${this.escape(t)}`)).map(({column_name:n,column_type:r,null:a})=>({name:n,type:ht(r),nullable:a!=="NO",databaseType:r}))}static async of(t={},n={}){const r=await pt();return n.query?.castTimestampToDate===void 0&&(n={...n,query:{...n.query,castTimestampToDate:!0}}),n.query?.castBigIntToDouble===void 0&&(n={...n,query:{...n.query,castBigIntToDouble:!0}}),await r.open(n),await Promise.all(Object.entries(t).map(async([a,s])=>{if(s instanceof w)await ae(r,a,s);else if(j(s))await I(r,a,s);else if(Array.isArray(s))await se(r,a,s);else if(L(s))await dt(r,a,s);else if("data"in s){const{data:o,...c}=s;j(o)?await I(r,a,o,c):await se(r,a,o,c)}else if("file"in s){const{file:o,...c}=s;await ae(r,a,o,c)}else throw new Error(`invalid source: ${s}`)})),new ke(r)}};Object.defineProperty(U.prototype,"dialect",{value:"duckdb"});async function ae(e,t,n,r){const a=await n.url();if(a.startsWith("blob:")){const o=await n.arrayBuffer();await e.registerFileBuffer(n.name,new Uint8Array(o))}else await e.registerFileURL(n.name,new URL(a,location).href,4);const s=await e.connect();try{switch(n.mimeType){case"text/csv":case"text/tab-separated-values":return await s.insertCSVFromPath(n.name,{name:t,schema:"main",...r}).catch(async o=>{if(o.toString().includes("Could not convert"))return await mt(s,n,t);throw o});case"application/json":return await s.insertJSONFromPath(n.name,{name:t,schema:"main",...r});default:if(/\.arrow$/i.test(n.name)){const o=new Uint8Array(await n.arrayBuffer());return await s.insertArrowFromIPCStream(o,{name:t,schema:"main",...r})}if(/\.parquet$/i.test(n.name))return await s.query(`CREATE VIEW '${t}' AS SELECT * FROM parquet_scan('${n.name}')`);throw new Error(`unknown file type: ${n.mimeType}`)}}finally{await s.close()}}async function mt(e,t,n){return await(await e.prepare(`CREATE TABLE '${n}' AS SELECT * FROM read_csv_auto(?, ALL_VARCHAR=TRUE)`)).send(t.name)}async function I(e,t,n,r){const a=await e.connect();try{await a.insertArrowTable(n,{name:t,schema:"main",...r})}finally{await a.close()}}async function dt(e,t,n){const r=(await D()).tableFromIPC(n.toArrowBuffer());return await I(e,t,r)}async function se(e,t,n,r){const a=(await D()).tableFromJSON(n);return await I(e,t,a,r)}async function bt(){const e=await import(`${g}${N.resolve()}`),t=await e.selectBundle({mvp:{mainModule:`${g}${N.resolve("dist/duckdb-mvp.wasm")}`,mainWorker:`${g}${N.resolve("dist/duckdb-browser-mvp.worker.js")}`},eh:{mainModule:`${g}${N.resolve("dist/duckdb-eh.wasm")}`,mainWorker:`${g}${N.resolve("dist/duckdb-browser-eh.worker.js")}`}}),n=new e.ConsoleLogger;return{module:e,bundle:t,logger:n}}async function pt(){F===void 0&&(F=bt());const{module:e,bundle:t,logger:n}=await F,r=await e.createWorker(t.mainWorker),a=new e.AsyncDuckDB(n,r);return await a.instantiate(t.mainModule),a}function ht(e){switch(e){case"BIGINT":case"HUGEINT":case"UBIGINT":return"bigint";case"DOUBLE":case"REAL":case"FLOAT":return"number";case"INTEGER":case"SMALLINT":case"TINYINT":case"USMALLINT":case"UINTEGER":case"UTINYINT":return"integer";case"BOOLEAN":return"boolean";case"DATE":case"TIMESTAMP":case"TIMESTAMP WITH TIME ZONE":return"date";case"VARCHAR":case"UUID":return"string";default:return/^DECIMAL\(/.test(e)?"integer":"other"}}const B=20;function oe(e,t){return e&&(typeof e.sql=="function"||typeof e.queryTag=="function"&&(typeof e.query=="function"||typeof e.queryStream=="function"))&&(t!=="table"||typeof e.describeColumns=="function")&&e!==me}function x(e){return Array.isArray(e)&&(ie(e.schema)||ce(e.columns)||wt(e)||ue(e)||le(e))||fe(e)}function wt(e){const t=Math.min(B,e.length);for(let n=0;n<t;++n){const r=e[n];if(r===null||typeof r!="object")return!1}return t>0&&yt(e[0])}function yt(e){for(const t in e)return!0;return!1}function ie(e){return Array.isArray(e)&&e.every(vt)}function ce(e){return Array.isArray(e)&&e.every(t=>typeof t=="string")}function vt(e){return e&&typeof e.name=="string"&&typeof e.type=="string"}function W(e){return fe(e)||ue(e)||le(e)}function ue(e){const t=Math.min(B,e.length);if(!(t>0))return!1;let n,r=!1;for(let a=0;a<t;++a){const s=e[a];if(s==null)continue;const o=typeof s;if(n===void 0)switch(o){case"number":case"boolean":case"string":case"bigint":n=o;break;default:return!1}else if(o!==n)return!1;r=!0}return r}function le(e){const t=Math.min(B,e.length);if(!(t>0))return!1;let n=!1;for(let r=0;r<t;++r){const a=e[r];if(a!=null){if(!(a instanceof Date))return!1;n=!0}}return n}function fe(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}const me=Object.assign(async(e,t,n,r)=>{if(e=await de(await e,r),oe(e))return pe(e,he(t,e),n);if(x(e))return Ae(e,t);throw e?new Error("invalid data source"):new Error("missing data source")},{sql(e,t,n){return async function(){return pe(await be(await e,n),arguments,t)}}});async function gt(e,t,n){switch(t){case"chart":return $t(e);case"table":return de(e,n);case"sql":return be(e,n)}return e}function z(e){const t=new WeakMap;return(n,r)=>{if(!n||typeof n!="object")throw new Error("invalid data source");let a=t.get(n);return(!a||x(n)&&n.length!==a._numRows)&&(a=e(n,r),a._numRows=n.length,t.set(n,a)),a}}const $t=z(async e=>{if(e instanceof w){switch(e.mimeType){case"text/csv":return e.csv({typed:"auto"});case"text/tab-separated-values":return e.tsv({typed:"auto"});case"application/json":return e.json()}throw new Error(`unsupported file type: ${e.mimeType}`)}return e}),de=z(async(e,t)=>{if(e instanceof w){switch(e.mimeType){case"text/csv":return e.csv();case"text/tab-separated-values":return e.tsv();case"application/json":return e.json();case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return A(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return j(e)||L(e)?A(e,t):x(e)&&W(e)?Array.from(e,n=>({value:n})):e}),be=z(async(e,t)=>{if(e instanceof w){switch(e.mimeType){case"text/csv":case"text/tab-separated-values":case"application/json":return A(e,t);case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return A(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return x(e)?A(await Et(e,t),t):j(e)||L(e)?A(e,t):e});async function Et(e,t){const n=await D();return W(e)?n.tableFromArrays({[t]:e}):n.tableFromJSON(e)}function A(e,t=e instanceof w?At(e):"__table"){return U.of({[t]:e})}function At(e){return e.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"")}async function pe(e,t,n){if(!e)throw new Error("missing data source");if(typeof e.queryTag=="function"){const r=new AbortController,a={signal:r.signal};if(n.then(()=>r.abort("invalidated")),typeof e.queryStream=="function")return Tt(e.queryStream(...e.queryTag.apply(e,t),a));if(typeof e.query=="function")return e.query(...e.queryTag.apply(e,t),a)}if(typeof e.sql=="function")return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}async function*Tt(e){let t=performance.now();const n=await e,r=[];r.done=!1,r.error=null,r.schema=n.schema;try{for await(const a of n.readRows()){performance.now()-t>150&&r.length>0&&(yield r,t=performance.now());for(const s of a)r.push(s)}r.done=!0,yield r}catch(a){r.error=a,yield r}}function he(e,t){const n=typeof t.escape=="function"?t.escape:i=>i,{select:r,from:a,filter:s,sort:o,slice:c}=e;if(!a.table)throw new Error("missing from table");if(r.columns&&r.columns.length===0)throw new Error("at least one column must be selected");const d=new Map(e.names?.map(({column:i,name:f})=>[i,f])),u=[[`SELECT ${r.columns?r.columns.map(i=>{const f=d.get(i);return f?`${n(i)} AS ${n(f)}`:n(i)}).join(", "):"*"} FROM ${Nt(a.table,n)}`]];for(let i=0;i<s.length;++i)h(i?`
AND `:`
WHERE `,u),jt(s[i],u,n);for(let i=0;i<o.length;++i)h(i?", ":`
ORDER BY `,u),we(o[i],u,n);if(t.dialect==="mssql"||t.dialect==="oracle"){if(c.to!==null||c.from!==null){if(!o.length){if(!r.columns)throw new Error("at least one column must be explicitly specified. Received '*'.");h(`
ORDER BY `,u),we({column:r.columns[0],direction:"ASC"},u,n)}h(`
OFFSET ${c.from||0} ROWS`,u),h(`
FETCH NEXT ${c.to!==null?c.to-(c.from||0):1e9} ROWS ONLY`,u)}}else(c.to!==null||c.from!==null)&&h(`
LIMIT ${c.to!==null?c.to-(c.from||0):1e9}`,u),c.from!==null&&h(` OFFSET ${c.from}`,u);return u}function Nt(e,t){if(typeof e=="object"){let n="";return e.database!=null&&(n+=t(e.database)+"."),e.schema!=null&&(n+=t(e.schema)+"."),n+=t(e.table),n}else return t(e)}function h(e,t){const n=t[0];n[n.length-1]+=e}function we({column:e,direction:t},n,r){h(`${r(e)} ${t.toUpperCase()}`,n)}function jt({type:e,operands:t},n,r){if(t.length<1)throw new Error("Invalid operand length");if(t.length===1||e==="v"||e==="nv")switch(T(t[0],n,r),e){case"n":case"nv":h(" IS NULL",n);return;case"nn":case"v":h(" IS NOT NULL",n);return;default:throw new Error("Invalid filter operation")}if(t.length===2&&!["in","nin"].includes(e))if(["c","nc"].includes(e)){switch(T(t[0],n,r),e){case"c":h(" LIKE ",n);break;case"nc":h(" NOT LIKE ",n);break}T(Ot(t[1]),n,r);return}else{switch(T(t[0],n,r),e){case"eq":h(" = ",n);break;case"ne":h(" <> ",n);break;case"gt":h(" > ",n);break;case"lt":h(" < ",n);break;case"gte":h(" >= ",n);break;case"lte":h(" <= ",n);break;default:throw new Error("Invalid filter operation")}T(t[1],n,r);return}switch(T(t[0],n,r),e){case"in":h(" IN (",n);break;case"nin":h(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}xt(t.slice(1),n),h(")",n)}function T(e,t,n){e.type==="column"?h(n(e.value),t):(t.push(e.value),t[0].push(""))}function xt(e,t){let n=!0;for(const r of e)n?n=!1:h(",",t),t.push(r.value),t[0].push("")}function Ot(e){return{...e,value:`%${e.value}%`}}function ye(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))}function qt(e,t){return ye(e,t)||(e<t?-1:e>t?1:0)}function Lt(e,t){return ye(e,t)||(e>t?-1:e<t?1:0)}const It=e=>typeof e=="number"&&!Number.isNaN(e),Rt=e=>Number.isInteger(e)&&!Number.isNaN(e),kt=e=>typeof e=="string",St=e=>typeof e=="boolean",Ct=e=>typeof e=="bigint",Mt=e=>e instanceof Date&&!isNaN(e),Pt=e=>e instanceof ArrayBuffer,_t=e=>Array.isArray(e),Dt=e=>typeof e=="object"&&e!==null,Ft=e=>e!=null;function H(e){switch(e){case"string":return kt;case"bigint":return Ct;case"boolean":return St;case"number":return It;case"integer":return Rt;case"date":return Mt;case"buffer":return Pt;case"array":return _t;case"object":return Dt;case"other":default:return Ft}}const ve=/^(([-+]\d{2})?\d{4}(-\d{2}(-\d{2}))|(\d{1,2})\/(\d{1,2})\/(\d{2,4}))([T ]\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function Ut(e,t){switch(t){case"string":return typeof e=="string"||e==null?e:String(e);case"boolean":if(typeof e=="string"){const n=e.trim().toLowerCase();return n==="true"?!0:n==="false"?!1:null}return typeof e=="boolean"||e==null?e:!!e;case"bigint":return typeof e=="bigint"||e==null?e:Number.isInteger(typeof e=="string"&&!e.trim()?NaN:+e)?BigInt(e):void 0;case"integer":case"number":return typeof e=="number"?e:e==null||typeof e=="string"&&!e.trim()?NaN:Number(e);case"date":{if(e instanceof Date||e==null)return e;if(typeof e=="number")return new Date(e);const n=String(e).trim();return typeof e=="string"&&!n?null:new Date(ve.test(n)?n:NaN)}case"array":case"object":case"buffer":case"other":return e;default:throw new Error(`Unable to coerce to type: ${t}`)}}function ge(e){const{columns:t}=e;let{schema:n}=e;return ie(n)?{schema:n,inferred:!1}:(n=G(e,ce(t)?t:void 0),{schema:n,inferred:!0})}function $e(e,t){const n=e;let{schema:r,inferred:a}=ge(e);const s=new Map(r.map(({name:o,type:c})=>[o,c]));if(t.types){for(const{name:o,type:c}of t.types){s.set(o,c),r===n.schema&&(r=r.slice());const d=r.findIndex(u=>u.name===o);d>-1&&(r[d]={...r[d],type:c})}e=e.map(o=>V(o,s,r))}else a&&(e=e.map(o=>V(o,s,r)));return{source:e,schema:r}}function Ee(e,t){if(!t.names)return e;const n=new Map(t.names.map(r=>[r.column,r]));return e.map(r=>Object.fromEntries(Object.keys(r).map(a=>[n.get(a)?.name??a,r[a]])))}function Ae(e,t){const n=new Map,r=e,a=$e(e,t);e=a.source;let s=a.schema;if(t.derive){const u=[];t.derive.map(({name:f,value:b})=>{let l=[];Ee(e,t).map((m,y)=>{let q;try{q=b(m)}catch(Se){l.push({index:y,error:Se}),q=void 0}u[y]?u[y]={...u[y],[f]:q}:u.push({[f]:q})}),l.length&&n.set(f,l)});const i=$e(u,t);e=e.map((f,b)=>({...f,...i.source[b]})),s=[...s,...i.schema]}for(const{type:u,operands:i}of t.filter){const[{value:f}]=i,b=i.slice(1).map(({value:l})=>l);switch(u){case"v":{const[l]=b,m=H(l);e=e.filter(y=>m(y[f]));break}case"nv":{const[l]=b,m=H(l);e=e.filter(y=>!m(y[f]));break}case"eq":{const[l]=b;if(l instanceof Date){const m=+l;e=e.filter(y=>+y[f]===m)}else e=e.filter(m=>m[f]===l);break}case"ne":{const[l]=b;e=e.filter(m=>m[f]!==l);break}case"c":{const[l]=b;e=e.filter(m=>typeof m[f]=="string"&&m[f].includes(l));break}case"nc":{const[l]=b;e=e.filter(m=>typeof m[f]=="string"&&!m[f].includes(l));break}case"in":{const l=new Set(b);e=e.filter(m=>l.has(m[f]));break}case"nin":{const l=new Set(b);e=e.filter(m=>!l.has(m[f]));break}case"n":{e=e.filter(l=>l[f]==null);break}case"nn":{e=e.filter(l=>l[f]!=null);break}case"lt":{const[l]=b;e=e.filter(m=>m[f]<l);break}case"lte":{const[l]=b;e=e.filter(m=>m[f]<=l);break}case"gt":{const[l]=b;e=e.filter(m=>m[f]>l);break}case"gte":{const[l]=b;e=e.filter(m=>m[f]>=l);break}default:throw new Error(`unknown filter type: ${u}`)}}for(const{column:u,direction:i}of Be(t.sort)){const f=i==="desc"?Lt:qt;e===r&&(e=e.slice()),e.sort((b,l)=>f(b[u],l[u]))}let{from:o,to:c}=t.slice;o=o==null?0:Math.max(0,o),c=c==null?1/0:Math.max(0,c),(o>0||c<1/0)&&(e=e.slice(Math.max(0,o),Math.max(0,c)));let d=s.slice();if(t.select.columns){if(s){const u=new Map(s.map(i=>[i.name,i]));s=t.select.columns.map(i=>u.get(i))}e=e.map(u=>Object.fromEntries(t.select.columns.map(i=>[i,u[i]])))}if(t.names){const u=new Map(t.names.map(i=>[i.column,i]));s&&(s=s.map(i=>{const f=u.get(i.name);return{...i,...f?{name:f.name}:null}})),d&&(d=d.map(i=>{const f=u.get(i.name);return{...i,...f?{name:f.name}:null}})),e=Ee(e,t)}return e!==r&&s&&(e.schema=s),e.fullSchema=d,e.errors=n,e}function V(e,t,n){const r={};for(const a of n){const s=t.get(a.name),o=e[a.name];r[a.name]=s==="raw"?o:Ut(o,s)}return r}function Bt(){return{boolean:0,integer:0,number:0,date:0,string:0,array:0,object:0,bigint:0,buffer:0,defined:0}}const Wt=["boolean","integer","number","date","bigint","array","object","buffer"];function zt(e){const t=new Set;for(const n of e)if(n)for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.add(r);return Array.from(t)}function G(e,t=zt(e)){const n=[],r=e.slice(0,100);for(const a of t){const s=Bt();for(const d of r){let u=d[a];if(u==null)continue;const i=typeof u;if(i!=="string")++s.defined,Array.isArray(u)?++s.array:u instanceof Date?++s.date:u instanceof ArrayBuffer?++s.buffer:i==="number"?(++s.number,Number.isInteger(u)&&++s.integer):i in s&&++s[i];else{if(u=u.trim(),!u)continue;++s.defined,++s.string,/^(true|false)$/i.test(u)?++s.boolean:u&&!isNaN(u)?(++s.number,Number.isInteger(+u)&&++s.integer):ve.test(u)&&++s.date}}const o=Math.max(1,s.defined*.9),c=We(Wt,d=>s[d]>=o?s[d]:NaN)??(s.string>=o?"string":"other");n.push({name:a,type:c,inferred:c})}return n}class Ht{constructor(t){Object.defineProperties(this,{_:{value:t},sheetNames:{value:t.worksheets.map(n=>n.name),enumerable:!0}})}sheet(t,n){const r=typeof t=="number"?this.sheetNames[t]:this.sheetNames.includes(t+="")?t:null;if(r==null)throw new Error(`Sheet not found: ${t}`);const a=this._.getWorksheet(r);return Vt(a,n)}}function Vt(e,{range:t,headers:n}={}){let[[r,a],[s,o]]=Gt(t,e);const c=n?e._rows[a++]:null;let d=new Set(["#"]);for(let i=r;i<=s;i++){const f=c?Te(c.findCell(i+1)):null;let b=f&&f+""||Yt(i);for(;d.has(b);)b+="_";d.add(b)}d=new Array(r).concat(Array.from(d));const u=new Array(o-a+1);for(let i=a;i<=o;i++){const f=u[i-a]=Object.create(null,{"#":{value:i+1}}),b=e.getRow(i+1);if(b.hasValues)for(let l=r;l<=s;l++){const m=Te(b.findCell(l+1));m!=null&&(f[d[l+1]]=m)}}return u.columns=d.filter(()=>!0),u}function Te(e){if(!e)return;const{value:t}=e;if(t&&typeof t=="object"&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return Ne(t);if(t.text){let{text:n}=t;return n.richText&&(n=Ne(n)),t.hyperlink&&t.hyperlink!==n?`${t.hyperlink} ${n}`:n}return t}return t}function Ne(e){return e.richText.map(t=>t.text).join("")}function Gt(e=":",{columnCount:t,rowCount:n}){if(e+="",!e.match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[r=0,a=0],[s=t-1,o=n-1]]=e.split(":").map(Zt);return[[r,a],[s,o]]}function Yt(e){let t="";e++;do t=String.fromCharCode(64+(e%26||26))+t;while(e=Math.floor((e-1)/26));return t}function Zt(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let r=0;if(t)for(let a=0;a<t.length;a++)r+=Math.pow(26,t.length-a-1)*(t.charCodeAt(a)-64);return[r?r-1:void 0,n?+n-1:void 0]}async function v(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}function Jt(e,t){const n=new Map(t.map(({name:r,type:a})=>[r,a]));return Object.assign(e.map(r=>V(r,n,t)),{schema:t})}async function je(e,t,{array:n=!1,typed:r=!1}={}){const a=await e.text(),s=t==="	"?n?Me:Pe:n?_e:De;if(r==="auto"&&!n){const o=s(a);return Jt(o,G(o,o.columns))}return s(a,r&&Ce)}let R=class{constructor(t,n){Object.defineProperty(this,"name",{value:t,enumerable:!0}),n!==void 0&&Object.defineProperty(this,"mimeType",{value:n+"",enumerable:!0})}async blob(){return(await v(this)).blob()}async arrayBuffer(){return(await v(this)).arrayBuffer()}async text(){return(await v(this)).text()}async json(){return(await v(this)).json()}async stream(){return(await v(this)).body}async csv(t){return je(this,",",t)}async tsv(t){return je(this,"	",t)}async image(t){const n=await this.url();return new Promise((r,a)=>{const s=new Image;new URL(n,document.baseURI).origin!==new URL(location).origin&&(s.crossOrigin="anonymous"),Object.assign(s,t),s.onload=()=>r(s),s.onerror=()=>a(new Error(`Unable to load file: ${this.name}`)),s.src=n})}async arrow({version:t=4}={}){switch(t){case 4:{const[n,r]=await Promise.all([$(C.resolve()),v(this)]);return n.Table.from(r)}case 9:{const[n,r]=await Promise.all([import(`${g}${tt.resolve()}`),v(this)]);return n.tableFromIPC(r)}case 11:{const[n,r]=await Promise.all([import(`${g}${ee.resolve()}`),v(this)]);return n.tableFromIPC(r)}default:throw new Error(`unsupported arrow version: ${t}`)}}async sqlite(){return M.open(v(this))}async zip(){const[t,n]=await Promise.all([$(Je.resolve()),this.arrayBuffer()]);return new Kt(await t.loadAsync(n))}async xml(t="application/xml"){return new DOMParser().parseFromString(await this.text(),t)}async html(){return this.xml("text/html")}async xlsx(){const[t,n]=await Promise.all([$(at.resolve()),this.arrayBuffer()]);return new Ht(await new t.Workbook().xlsx.load(n))}},w=class extends R{constructor(t,n,r){super(n,r),Object.defineProperty(this,"_url",{value:t})}async url(){return await this._url+""}};function Xt(e){throw new Error(`File not found: ${e}`)}function Qt(e){return Object.assign(t=>{const n=e(t+="");if(n==null)throw new Error(`File not found: ${t}`);if(typeof n=="object"&&"url"in n){const{url:r,mimeType:a}=n;return new w(r,t,a)}return new w(n,t)},{prototype:w.prototype})}class Kt{constructor(t){Object.defineProperty(this,"_",{value:t}),this.filenames=Object.keys(t.files).filter(n=>!t.files[n].dir)}file(t){const n=this._.file(t+="");if(!n||n.dir)throw new Error(`file not found: ${t}`);return new en(n)}}class en extends R{constructor(t){super(t.name),Object.defineProperty(this,"_",{value:t}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}function tn(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}function nn(e,t,n){n==null&&(n=devicePixelRatio);var r=document.createElement("canvas");r.width=e*n,r.height=t*n,r.style.width=e+"px";var a=r.getContext("2d");return a.scale(n,n),a}function rn(e,t="untitled",n="Save"){const r=document.createElement("a"),a=r.appendChild(document.createElement("button"));a.textContent=n,r.download=t;async function s(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(r.href),r.removeAttribute("href"),a.textContent=n,a.disabled=!1}return r.onclick=async o=>{if(a.disabled=!0,r.href)return s();a.textContent="Saving\u2026";try{const c=await(typeof e=="function"?e():e);a.textContent="Download",r.href=URL.createObjectURL(c)}catch{a.textContent=n}if(o.eventPhase)return s();a.disabled=!1},r}var k={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function an(e,t){var n=e+="",r=n.indexOf(":"),a;r>=0&&(n=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1));var s=k.hasOwnProperty(n)?document.createElementNS(k[n],e):document.createElement(e);if(t)for(var o in t)n=o,r=n.indexOf(":"),a=t[o],r>=0&&(n=o.slice(0,r))!=="xmlns"&&(o=o.slice(r+1)),k.hasOwnProperty(n)?s.setAttributeNS(k[n],o,a):s.setAttribute(o,a);return s}function sn(e){var t=document.createElement("input");return e!=null&&(t.type=e),t}function on(e,t,n){arguments.length===1&&(t=e,e=null);var r=document.createElement("input");return r.min=e=e==null?0:+e,r.max=t=t==null?1:+t,r.step=n==null?"any":n=+n,r.type="range",r}function cn(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,function(n){var r=document.createElement("option");r.value=r.textContent=n,t.appendChild(r)}),t}function un(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n}function ln(e){return document.createTextNode(e)}var fn=0;function xe(e){return new Oe("O-"+(e==null?"":e+"-")+ ++fn)}function Oe(e){this.id=e,this.href=new URL(`#${e}`,location)+""}Oe.prototype.toString=function(){return"url("+this.href+")"};var mn=Object.freeze({__proto__:null,canvas:tn,context2d:nn,download:rn,element:an,input:sn,range:on,select:cn,svg:un,text:ln,uid:xe});function dn(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}function bn(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)})}function pn(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)})}var hn=Object.freeze({__proto__:null,buffer:dn,text:bn,url:pn});function Y(){return this}function qe(e,t){let n=!1;if(typeof t!="function")throw new Error("dispose is not a function");return{[Symbol.iterator]:Y,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}function*wn(e,t){for(var n,r=-1;!(n=e.next()).done;)t(n.value,++r)&&(yield n.value)}function O(e){let t=!1,n,r;const a=e(s);if(a!=null&&typeof a!="function")throw new Error(typeof a.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function s(c){return r?(r(c),r=null):t=!0,n=c}function o(){return{done:!1,value:t?(t=!1,Promise.resolve(n)):new Promise(c=>r=c)}}return{[Symbol.iterator]:Y,throw:()=>({done:!0}),return:()=>(a?.(),{done:!0}),next:o}}function yn(e){return O(function(t){var n=vn(e),r=Le(e);function a(){t(Le(e))}return e.addEventListener(n,a),r!==void 0&&t(r),function(){e.removeEventListener(n,a)}})}function Le(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,t=>t.value);default:return e.value}}function vn(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}function*gn(e,t){for(var n,r=-1;!(n=e.next()).done;)yield t(n.value,++r)}function $n(e){let t;const n=[],r=e(a);if(r!=null&&typeof r!="function")throw new Error(typeof r.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function a(o){return n.push(o),t&&(t(n.shift()),t=null),o}function s(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise(o=>t=o)}}return{[Symbol.iterator]:Y,throw:()=>({done:!0}),return:()=>(r?.(),{done:!0}),next:s}}function*En(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0;++r<a;)yield e+r*n}function An(e,t){if(!(!isFinite(t=+t)||t<0||t!==t|0)){for(var n,r=-1;!(n=e.next()).done;)if(++r===t)return n.value}}function Tn(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return qe(n,()=>{n.terminate(),URL.revokeObjectURL(t)})}var Nn=Object.freeze({__proto__:null,disposable:qe,filter:wn,input:yn,map:gn,observe:O,queue:$n,range:En,valueAt:An,worker:Tn});function Z(e,t){return function(n){var r=n[0],a=[],s,o=null,c,d,u,i,f,b,l,m=-1;for(i=1,f=arguments.length;i<f;++i){if(s=arguments[i],s instanceof Node)a[++m]=s,r+="<!--o:"+m+"-->";else if(Array.isArray(s)){for(b=0,l=s.length;b<l;++b)c=s[b],c instanceof Node?(o===null&&(a[++m]=o=document.createDocumentFragment(),r+="<!--o:"+m+"-->"),o.appendChild(c)):(o=null,r+=c);o=null}else r+=s;r+=n[i]}if(o=e(r),++m>0){for(d=new Array(m),u=document.createTreeWalker(o,NodeFilter.SHOW_COMMENT,null,!1);u.nextNode();)c=u.currentNode,/^o:/.test(c.nodeValue)&&(d[+c.nodeValue.slice(2)]=c);for(i=0;i<m;++i)(c=d[i])&&c.parentNode.replaceChild(a[i],c)}return o.childNodes.length===1?o.removeChild(o.firstChild):o.nodeType===11?((c=t()).appendChild(o),c):o}}const jn=Z(function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)},function(){return document.createElement("span")});async function xn(e){const t=await e(te.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(te.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}function On(e){return e(Xe.resolve()).then(function(t){return Z(function(n){var r=document.createElement("div");r.innerHTML=t(n,{langPrefix:""}).trim();var a=r.querySelectorAll("pre code[class]");return a.length>0&&e(S.resolve()).then(function(s){a.forEach(function(o){function c(){s.highlightBlock(o),o.parentNode.classList.add("observablehq--md-pre")}s.getLanguage(o.className)?c():e(S.resolve("async-languages/index.js")).then(d=>{if(d.has(o.className))return e(S.resolve("async-languages/"+d.get(o.className))).then(u=>{s.registerLanguage(o.className,u)})}).then(c,c)})}),r},function(){return document.createElement("div")})})}async function qn(e){const t=await e(st.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const n=document.createElement("div");return n.innerHTML=t.render(xe().id,String.raw.apply(String,arguments)),n.removeChild(n.firstChild)}}function Ln(e){let t;Object.defineProperties(this,{generator:{value:O(n=>void(t=n))},value:{get:()=>e,set:n=>t(e=n)}}),e!==void 0&&t(e)}function*In(){for(;;)yield Date.now()}function Rn(e,t){return new Promise(function(n){setTimeout(function(){n(t)},e)})}var J=new Map;function kn(e,t){var n=new Promise(function(r){J.delete(t);var a=t-e;if(!(a>0))throw new Error("invalid time");if(a>2147483647)throw new Error("too long to wait");setTimeout(r,a)});return J.set(t,n),n}function Ie(e,t){var n;return(n=J.get(e=+e))?n.then(()=>t):(n=Date.now())>=e?Promise.resolve(t):kn(n,e).then(()=>t)}function Sn(e,t){return Ie(Math.ceil((Date.now()+1)/e)*e,t)}var Cn=Object.freeze({__proto__:null,delay:Rn,tick:Sn,when:Ie});function Mn(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,t??location).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}const Pn=Z(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t},function(){return document.createElementNS("http://www.w3.org/2000/svg","g")});var _n=String.raw;function Dn(e){return new Promise(function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=n,r.onload=t,document.head.appendChild(r)})}function Fn(e){return Promise.all([e(Q.resolve()),e.resolve(Q.resolve("dist/katex.min.css")).then(Dn)]).then(function(t){var n=t[0],r=a();function a(s){return function(){var o=document.createElement("div");return n.render(_n.apply(String,arguments),o,s),o.removeChild(o.firstChild)}}return r.options=a,r.block=a({displayMode:!0}),r})}async function Un(e){const[t,n,r]=await Promise.all([Qe,Ke,et].map(a=>e(a.resolve())));return r.register(t,n)}function Bn(){return O(function(e){var t=e(document.body.clientWidth);function n(){var r=document.body.clientWidth;r!==t&&e(t=r)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}})}const Wn=Object.assign(Object.defineProperties(function(e){const t=it(e);Object.defineProperties(this,zn({FileAttachment:()=>Xt,Mutable:()=>Ln,now:In,width:Bn,dot:()=>t(Ge.resolve()),htl:()=>t(Ze.resolve()),html:()=>jn,md:()=>On(t),svg:()=>Pn,tex:()=>Fn(t),_:()=>t(Ye.resolve()),aq:()=>t.alias({"apache-arrow":C.resolve()})(nt.resolve()),Arrow:()=>t(C.resolve()),d3:()=>t(ze.resolve()),DuckDBClient:()=>U,Inputs:()=>t(He.resolve()).then(n=>({...n,file:n.fileOf(R)})),L:()=>xn(t),mermaid:()=>qn(t),Plot:()=>t(Ve.resolve()),__query:()=>me,require:()=>t,resolve:()=>Mn,SQLite:()=>ne(t),SQLiteDatabaseClient:()=>M,topojson:()=>t(rt.resolve()),vl:()=>Un(t),aapl:()=>new w("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new w("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new w("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new w("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new w("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new w("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new w("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new w("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new w("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new w("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),pizza:()=>new w("https://static.observableusercontent.com/files/c653108ab176088cacbb338eaf2344c4f5781681702bd6afb55697a3f91b511c6686ff469f3e3a27c75400001a2334dbd39a4499fe46b50a8b3c278b7d2f7fb5").csv({typed:!0}),weather:()=>new w("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:mn,Files:hn,Generators:Nn,Promises:Cn}))},{resolve:{get:()=>$.resolve,enumerable:!0,configurable:!0},require:{get:()=>$,set:ot,enumerable:!0,configurable:!0}}),{resolveFrom:Ue,requireFrom:X});function zn(e){return Object.fromEntries(Object.entries(e).map(Hn))}function Hn([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}export{R as AbstractFile,Qt as FileAttachments,Wn as Library,Ae as applyDataTableOperations,W as arrayIsPrimitive,re as getArrowTableSchema,ge as getSchema,H as getTypeValidator,G as inferSchema,L as isArqueroTable,j as isArrowTable,x as isDataArray,oe as isDatabaseClient,gt as loadDataSource,he as makeQueryTemplate,O as observe};
